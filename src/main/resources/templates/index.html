<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SpOntecular</title>
    <header th:replace="~{fragments :: headers}"></header>
  </head>
  <body class="bg-gray-100">
    <form th:action="@{/export}" method="post">
      <div
        class="container relative mx-auto my-10 flex flex-wrap items-stretch rounded-md border bg-white p-2 shadow-lg"
        x-data="{showButtons: false, inputText: '', showModal: false}"
      >
        <div class="h-[800px] w-full lg:w-1/2" id="specificationDiv">
          <div
            class="flex h-full items-center justify-center rounded-md border border-gray-300 bg-gray-200 p-2 focus:border-indigo-500 focus:outline-none"
          >
            <div class="flex flex-col items-center space-y-3">
              <button
                class="flex w-64 transform items-center space-x-2 rounded border border-gray-400 bg-white px-4 py-2 font-semibold text-gray-800 shadow transition hover:bg-blue-200"
                type="button"
                onclick="document.getElementById('wordFileInput').click();"
              >
                <i class="bi bi-file-earmark-word text-2xl text-blue-600"></i>
                <span>Import from Word</span>
              </button>
              <button
                class="flex w-64 transform items-center space-x-2 rounded border border-gray-400 bg-white px-4 py-2 font-semibold text-gray-800 shadow transition hover:bg-red-200"
                type="button"
                onclick="document.getElementById('pdfFileInput').click();"
              >
                <i class="bi bi-file-earmark-pdf text-2xl text-red-600"></i>
                <span>Import from PDF</span>
              </button>
              <button
                class="flex w-64 transform items-center space-x-2 rounded border border-gray-400 bg-white px-4 py-2 font-semibold text-gray-800 shadow transition hover:bg-green-200"
                hx-post="/loadSpecification?specification_type=example"
                hx-target="#specificationDiv"
              >
                <i class="bi bi-file-earmark-text text-2xl text-green-600"></i>
                <span>Example specification</span>
              </button>
            </div>
          </div>
        </div>
        <div
          class="w-full space-y-3 px-6 lg:w-1/2"
          x-data="{ specificationLoaded() { return this.inputText.trim() === ''; }}"
        >
          <div id="classesDiv">
            <div class="flex flex-col items-center pt-6">
              <button
                @click="showButtons = true;"
                :disabled="specificationLoaded()"
                :title="specificationLoaded() ? 'Please load or enter specification text.' : ''"
                class="flex items-center rounded px-6 py-2 text-white shadow-md"
                :class="specificationLoaded() ? 'bg-gray-200 cursor-not-allowed' : 'bg-blue-800 hover:bg-blue-900'"
                th:hx-post="@{/getClasses}"
                hx-target="#classesDiv"
                type="submit"
              >
                <i class="bi bi-rocket-takeoff mr-2 text-xl"></i>
                <span>Start Ontology Generation</span>
              </button>
              <button
                @click="showModal = true"
                type="button"
                class="mt-2"
                :class="specificationLoaded() ? 'text-gray-100 cursor-not-allowed' : 'text-gray-600'"
                :disabled="specificationLoaded()"
                :title="specificationLoaded() ? 'Please load or enter specification text.' : ''"
              >
                Settings
              </button>
            </div>
          </div>
          <div id="hierarchyDiv"></div>
          <div id="relationsDiv"></div>
          <div id="constraintsDiv"></div>
        </div>
        <div
          class="absolute bottom-0 right-0 mb-5 mr-5 flex items-center justify-end space-x-2"
          x-show="showButtons"
        >
          <a
            href="/restart"
            class="mr-6 font-bold text-gray-600 hover:underline hover:decoration-2 hover:underline-offset-8"
          >
            <i class="bi bi-arrow-clockwise" title="Reload"></i>
            Restart
          </a>
          <button
            type="submit"
            class="rounded bg-blue-500 px-4 py-2 text-white shadow-md hover:bg-blue-600"
          >
            Export
          </button>
        </div>
        <!-- Modal -->
        <div
          x-show="showModal"
          class="fixed inset-0 z-50 h-full w-full overflow-y-auto bg-gray-600 bg-opacity-50"
          x-transition:enter="transition ease-out duration-300"
          x-transition:enter-start="opacity-0"
          x-transition:enter-end="opacity-100"
          x-transition:leave="transition ease-in duration-300"
          x-transition:leave-start="opacity-100"
          x-transition:leave-end="opacity-0"
        >
          <div class="container mx-auto flex w-1/2 items-start justify-center">
            <div
              class="mt-10 w-full overflow-hidden rounded bg-white shadow-lg"
              @click.away="showModal = false"
            >
              <div class="flex items-center justify-between px-5 py-4">
                <h2 class="text-xl">Settings</h2>
                <button
                  type="button"
                  class="text-black"
                  @click="showModal = false"
                >
                  &times;
                </button>
              </div>
              <div class="h-[600px] overflow-y-auto">
                <div class="divide-y divide-solid">
                  <div
                    th:replace="~{settings-fragment :: settingItem('Classes', 'Enter class definition')}"
                  ></div>
                  <div
                    th:replace="~{settings-fragment :: settingItem('Hierarchy', 'Enter hierarchy definition')}"
                  ></div>
                  <div
                    th:replace="~{settings-fragment :: settingItem('Relations', 'Enter relations definition')}"
                  ></div>
                  <div
                    th:replace="~{settings-fragment :: settingItem('Constraints', 'Enter constraints definition')}"
                  ></div>
                </div>
              </div>

              <div class="w-100 flex items-center justify-end bg-gray-100 p-3">
                <button
                  type="button"
                  class="mr-6 font-bold text-gray-600 hover:underline hover:decoration-2 hover:underline-offset-8"
                  @click="showModal = false"
                >
                  Cancel
                </button>
                <button
                  type="button"
                  class="mr-6 rounded bg-blue-500 px-4 py-2 text-white hover:bg-blue-700"
                  hx-post="/updateFeature"
                  @click="showModal = false"
                >
                  Save
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>
    <form
      hx-post="/loadSpecification?specification_type=pdf"
      hx-target="#specificationDiv"
      hx-encoding="multipart/form-data"
      hx-trigger="change"
    >
      <input
        type="file"
        id="pdfFileInput"
        name="pdfFile"
        style="display: none"
        accept="application/pdf"
      />
    </form>
    <form
      hx-post="/loadSpecification?specification_type=word"
      hx-target="#specificationDiv"
      hx-encoding="multipart/form-data"
      hx-trigger="change"
    >
      <input
        type="file"
        id="wordFileInput"
        name="wordFile"
        style="display: none"
        accept=".docx"
      />
    </form>
    <th:block th:replace="~{fragments :: footer}"></th:block>
  </body>
</html>
